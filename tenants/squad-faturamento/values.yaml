# Argo CD Tenant - Squad Faturamento
# Configurações com SSO GitHub para teste

crds:
  install: false

#############################################
# CONFIGURAÇÕES DO SERVER
#############################################
configs:
  params:
    server.insecure: true

  # ConfigMap do Argo CD
  cm:
    url: http://localhost:9091

    # SSO desabilitado - configurar conforme ambiente de produção
    # Para Cloudflare OIDC, descomentar e configurar:
    # oidc.config: |
    #   name: Cloudflare
    #   issuer: https://<team-name>.cloudflareaccess.com
    #   clientID: <client-id>
    #   clientSecret: $oidc.cloudflare.clientSecret

  # RBAC - Squad Faturamento
  rbac:
    policy.csv: |
      # Roles para a squad (configurar grupos SSO em produção)
      p, role:squad-faturamento-admin, applications, *, squad-faturamento/*, allow
      p, role:squad-faturamento-admin, applicationsets, *, squad-faturamento/*, allow
      p, role:squad-faturamento-admin, logs, get, squad-faturamento/*, allow
      p, role:squad-faturamento-admin, exec, create, squad-faturamento/*, allow
      p, role:squad-faturamento-admin, projects, *, squad-faturamento, allow
      p, role:squad-faturamento-admin, repositories, *, *, allow
      p, role:squad-faturamento-admin, clusters, get, *, allow

      # Binding de grupos SSO (configurar em produção)
      # g, squad-faturamento-admins, role:squad-faturamento-admin

    policy.default: ""
    scopes: "[groups, email]"

#############################################
# RECURSOS DO SERVER
#############################################
server:
  service:
    type: ClusterIP

  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

#############################################
# CONTROLLER
#############################################
controller:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

#############################################
# REPO SERVER
#############################################
repoServer:
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

#############################################
# REDIS
#############################################
redis:
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 100m
      memory: 128Mi

#############################################
# DEX - HABILITADO PARA SSO
#############################################
dex:
  enabled: false  # Habilitar quando SSO estiver configurado

notifications:
  enabled: false

applicationSet:
  enabled: true
