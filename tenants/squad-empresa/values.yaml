# Argo CD Tenant - Squad Empresa
# Configurações com SSO GitHub para teste

crds:
  install: false

#############################################
# CONFIGURAÇÕES DO SERVER
#############################################
configs:
  params:
    server.insecure: true

  # ConfigMap do Argo CD
  cm:
    url: http://localhost:9092

    # SSO GitHub OAuth
    dex.config: |
      connectors:
        - type: github
          id: github
          name: GitHub
          config:
            clientID: Ov23liOjPSdciLv2j3dM
            clientSecret: $dex.github.clientSecret

  # RBAC - Squad Empresa
  rbac:
    policy.csv: |
      # Admin via GitHub
      p, role:squad-empresa-admin, applications, *, squad-empresa/*, allow
      p, role:squad-empresa-admin, applicationsets, *, squad-empresa/*, allow
      p, role:squad-empresa-admin, logs, get, squad-empresa/*, allow
      p, role:squad-empresa-admin, exec, create, squad-empresa/*, allow
      p, role:squad-empresa-admin, projects, *, squad-empresa, allow
      p, role:squad-empresa-admin, repositories, *, *, allow
      p, role:squad-empresa-admin, clusters, get, *, allow

      # Seu usuário GitHub como admin (username e ID numérico)
      g, Herograme, role:squad-empresa-admin
      g, 141376440, role:squad-empresa-admin

    policy.default: ""
    scopes: "[groups, email]"

  # Secret para GitHub OAuth
  secret:
    extra:
      dex.github.clientSecret: "e82adac283fffca29239acacc8ca75497cce354f"

#############################################
# RECURSOS DO SERVER
#############################################
server:
  service:
    type: ClusterIP

  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

#############################################
# CONTROLLER
#############################################
controller:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

#############################################
# REPO SERVER
#############################################
repoServer:
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

#############################################
# REDIS
#############################################
redis:
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 100m
      memory: 128Mi

#############################################
# DEX - HABILITADO PARA SSO
#############################################
dex:
  enabled: true

notifications:
  enabled: false

applicationSet:
  enabled: true
